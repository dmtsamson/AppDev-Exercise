{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/auth.service\";\nimport * as i2 from \"../../services/token-storage.service\";\nimport * as i3 from \"@angular/common/http\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/forms\";\nexport class LoginPageComponent {\n  constructor(authService, tokenStorage, http, router) {\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.http = http;\n    this.router = router;\n    this.form = {\n      username: null,\n      password: null\n    };\n  }\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.authService.isLoggedIn = true;\n      this.router.navigate([this.authService.redirectUrl]);\n    }\n  }\n  onSubmit() {\n    const {\n      username,\n      password\n    } = this.form;\n    this.authService.login(username, password).subscribe({\n      next: token => {\n        const clean = token.replace(/^\"+|\"+$/g, '');\n        this.tokenStorage.saveToken(clean);\n        this.authService.isLoggedIn = true;\n        const redirect = this.authService.redirectUrl || '/';\n        this.router.navigate([redirect]);\n      },\n      error: err => {\n        console.error('Login failed:', err);\n        alert('Login failed. Please check your credentials and try again.');\n      }\n    });\n    this.http.post(\"https://localhost:7193/api/Login/login\", {\n      username,\n      password\n    }).subscribe(data => {\n      this.tokenStorage.saveToken(data.id_token);\n      this.tokenStorage.saveUser(data.id);\n      this.router.navigate([this.authService.redirectUrl]);\n      window.location.reload();\n    });\n  }\n  static {\n    this.ɵfac = function LoginPageComponent_Factory(t) {\n      return new (t || LoginPageComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.TokenStorageService), i0.ɵɵdirectiveInject(i3.HttpClient), i0.ɵɵdirectiveInject(i4.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: LoginPageComponent,\n      selectors: [[\"app-login-page\"]],\n      decls: 19,\n      vars: 2,\n      consts: [[\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\"], [\"f\", \"ngForm\"], [\"for\", \"username\"], [\"type\", \"text\", \"name\", \"username\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"username\", \"ngModel\"], [\"for\", \"password\"], [\"type\", \"password\", \"name\", \"password\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"password\", \"ngModel\"], [\"type\", \"submit\"]],\n      template: function LoginPageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\")(1, \"h1\");\n          i0.ɵɵtext(2, \"Welcome Back\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"h3\");\n          i0.ɵɵtext(4, \"Login Here\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"form\", 0, 1);\n          i0.ɵɵlistener(\"ngSubmit\", function LoginPageComponent_Template_form_ngSubmit_5_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵelementStart(7, \"div\")(8, \"label\", 2);\n          i0.ɵɵtext(9, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"input\", 3, 4);\n          i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_Template_input_ngModelChange_10_listener($event) {\n            return ctx.form.username = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(12, \"div\")(13, \"label\", 5);\n          i0.ɵɵtext(14, \"Password\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"input\", 6, 7);\n          i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_Template_input_ngModelChange_15_listener($event) {\n            return ctx.form.password = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"button\", 8);\n          i0.ɵɵtext(18, \"Submit\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngModel\", ctx.form.username);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngModel\", ctx.form.password);\n        }\n      },\n      dependencies: [i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.NgModel, i5.NgForm],\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["LoginPageComponent","constructor","authService","tokenStorage","http","router","form","username","password","ngOnInit","getToken","isLoggedIn","navigate","redirectUrl","onSubmit","login","subscribe","next","token","clean","replace","saveToken","redirect","error","err","console","alert","post","data","id_token","saveUser","id","window","location","reload","i0","ɵɵdirectiveInject","i1","AuthService","i2","TokenStorageService","i3","HttpClient","i4","Router","selectors","decls","vars","consts","template","LoginPageComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","LoginPageComponent_Template_form_ngSubmit_5_listener","LoginPageComponent_Template_input_ngModelChange_10_listener","$event","LoginPageComponent_Template_input_ngModelChange_15_listener","ɵɵadvance","ɵɵproperty"],"sources":["C:\\Users\\junma\\Documents\\Mei_SchoolProjects\\Samson_LE4\\frontend\\src\\app\\components\\login-page\\login-page.component.ts","C:\\Users\\junma\\Documents\\Mei_SchoolProjects\\Samson_LE4\\frontend\\src\\app\\components\\login-page\\login-page.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { AuthService } from '../../services/auth.service';\nimport { TokenStorageService } from '../../services/token-storage.service';\nimport { Router } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\n\n\n@Component({\n  selector: 'app-login-page',\n  templateUrl: './login-page.component.html',\n  styleUrls: ['./login-page.component.css']\n})\nexport class LoginPageComponent implements OnInit {\n  form: any = {\n    username: null,\n    password: null\n  }\n\n  constructor(\n    private authService: AuthService,\n    private tokenStorage: TokenStorageService,\n    private http: HttpClient,\n    private router: Router) { }\n\n  ngOnInit(): void {\n    if (this.tokenStorage.getToken()) {\n      this.authService.isLoggedIn = true;\n      this.router.navigate([this.authService.redirectUrl]);\n    }\n  }\n\n  onSubmit() {\n    const {username, password} = this.form;\n    \n    this.authService.login(username, password).subscribe({\n      next: (token: string) => {\n        const clean = token.replace(/^\"+|\"+$/g, '');\n        this.tokenStorage.saveToken(clean);\n        this.authService.isLoggedIn = true;\n\n        const redirect = this.authService.redirectUrl || '/';\n        this.router.navigate([redirect]);\n      },\n      error: (err) => {\n        console.error('Login failed:', err);\n        alert('Login failed. Please check your credentials and try again.');\n      }\n    });\n\n    this.http.post<LoginPostData>(\"https://localhost:7193/api/Login/login\", { username, \n      password}).subscribe(data => {\n        this.tokenStorage.saveToken(data.id_token);\n        this.tokenStorage.saveUser(data.id);\n        this.router.navigate([this.authService.redirectUrl]);\n        window.location.reload();\n      })\n    }\n  }\n\n  export interface LoginPostData {\n    id_token: string;\n    id: number;\n  }\n","<div>\n    <h1>Welcome Back</h1>\n    <h3>Login Here</h3>\n    <form name=\"form\" (ngSubmit)=\"onSubmit()\" #f=\"ngForm\" novalidate>\n        <div>\n            <label for=\"username\">Email</label>\n            <input\n                type=\"text\"\n                name=\"username\"\n                [(ngModel)]=\"form.username\"\n                required\n                #username=\"ngModel\"/>\n        </div>\n        \n        <div>\n\n            <label for=\"password\">Password</label>\n            <input type=\"password\"\n                name=\"password\"\n                [(ngModel)]=\"form.password\"\n                required\n                #password=\"ngModel\"/>\n        </div>\n        <button type=\"submit\">Submit</button>\n    </form>\n</div>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}